"use strict";(self["webpackChunkcovid19_exercise"]=self["webpackChunkcovid19_exercise"]||[]).push([[925],{925:function(t,e,a){a.r(e),a.d(e,{default:function(){return W}});var i=a(252),s=a(577),n=a(963);const r={class:"city"},l={class:"main"},c={class:"row align-items-start py-5"},o={class:"col-xl-5 col-12 mb-4 mt-3"},u={class:"col-xl-7 col-12"},g={class:"d-flex flex-wrap justify-content-end justify-content-xl-start mb-3"},h={class:"d-flex align-items-center"},p=(0,i._)("span",null,"顯示筆數",-1),d=["value"],m={class:"table-responsive text-center"},y={class:"table table-striped table-sm"},P=(0,i._)("thead",null,[(0,i._)("tr",null,[(0,i._)("th",{scope:"col"},"NO."),(0,i._)("th",{scope:"col"},"日期"),(0,i._)("th",{scope:"col"},"縣市"),(0,i._)("th",{scope:"col"},"鄉鎮"),(0,i._)("th",{scope:"col"},"性別"),(0,i._)("th",{scope:"col"},"年齡層")])],-1);function w(t,e,a,w,L,_){const v=(0,i.up)("PageTitle"),f=(0,i.up)("ButtonFilter"),x=(0,i.up)("DoughnutChart"),b=(0,i.up)("ButtonPagination");return(0,i.wg)(),(0,i.iD)("div",r,[(0,i.Wm)(v,{text:"台灣各縣市確診案例"}),(0,i._)("div",l,[(0,i.Wm)(f,{class:"mb-3",itemList:_.cityLocalList,itemIndex:L.cityCurrentIndex,onFilter:_.changeIndexHandler},null,8,["itemList","itemIndex","onFilter"]),(0,i._)("div",c,[(0,i._)("div",o,[(0,i.Wm)(x,{chartData:_.chartData},null,8,["chartData"])]),(0,i._)("div",u,[(0,i._)("div",g,[(0,i._)("div",h,[p,(0,i.wy)((0,i._)("select",{class:"form-select form-select-sm w-auto ms-2","onUpdate:modelValue":e[0]||(e[0]=t=>L.perPageIndex=t)},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(L.perPageList,((t,e)=>((0,i.wg)(),(0,i.iD)("option",{key:t,value:e},(0,s.zw)(t),9,d)))),128))],512),[[n.bM,L.perPageIndex]])])]),(0,i._)("div",m,[(0,i._)("table",y,[P,(0,i._)("tbody",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(_.pageList,((t,e)=>((0,i.wg)(),(0,i.iD)("tr",{key:t.id},[(0,i._)("td",null,(0,s.zw)((this.currentPage-1)*this.perPage+e+1),1),(0,i._)("td",null,(0,s.zw)(t.date),1),(0,i._)("td",null,(0,s.zw)(t.city),1),(0,i._)("td",null,(0,s.zw)(t.town),1),(0,i._)("td",null,(0,s.zw)(t.gender),1),(0,i._)("td",null,(0,s.zw)(t.age),1)])))),128))])])]),(0,i.Wm)(b,{class:"mt-2",totalPages:_.totalPages,currentPage:L.currentPage,onChange:_.changeCurrentPage},null,8,["totalPages","currentPage","onChange"])])])])])}var L=a(50);const _={class:"filter text-center"},v=["onClick"];function f(t,e,a,n,r,l){return(0,i.wg)(),(0,i.iD)("div",_,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.itemList,((e,n)=>((0,i.wg)(),(0,i.iD)("button",{type:"button",class:(0,s.C_)(["btn btn-outline-primary m-1",{active:n===a.itemIndex}]),key:e.title,onClick:e=>t.$emit("filter",n)},[(0,i.Uk)((0,s.zw)(e.title)+" ",1),(0,i._)("span",null,"("+(0,s.zw)(e.num)+")",1)],10,v)))),128))])}var x={name:"ButtonFilter",props:{itemList:Array,itemIndex:Number}},b=a(744);const C=(0,b.Z)(x,[["render",f]]);var D=C;const I={class:"page text-center"},k={class:"pagination flex-wrap justify-content-center justify-content-xl-end"},z=["onClick"];function B(t,e,a,r,l,c){return(0,i.wg)(),(0,i.iD)("div",I,[(0,i.wy)((0,i._)("ul",k,[(0,i._)("li",{class:(0,s.C_)(["page-item",{disabled:a.currentPage<=1}])},[(0,i._)("button",{class:"page-link",onClick:e[0]||(e[0]=e=>t.$emit("change",a.currentPage-1))},"Prev")],2),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.totalPages,(e=>(0,i.wy)(((0,i.wg)(),(0,i.iD)("li",{class:(0,s.C_)(["page-item",{active:e===a.currentPage}]),key:e},[(0,i._)("button",{class:"page-link",onClick:a=>t.$emit("change",e)},(0,s.zw)(e),9,z)],2)),[[n.F8,e<=a.currentPage+2&&e>=a.currentPage-2]]))),128)),(0,i._)("li",{class:(0,s.C_)(["page-item",{disabled:a.currentPage>=a.totalPages}])},[(0,i._)("button",{class:"page-link",onClick:e[1]||(e[1]=e=>t.$emit("change",a.currentPage+1))},"Next")],2)],512),[[n.F8,a.totalPages>1]])])}var F={name:"ButtonPagination",props:{totalPages:Number,currentPage:Number}};const H=(0,b.Z)(F,[["render",B]]);var N=H,T=a(764),$=a(728);$.kL.register($.Dx,$.u,$.De,$.qi,$.uw);var j=(0,i.aZ)({name:"DoughnutChart",components:{Doughnut:T.$I},props:{chartData:{type:Object},chartTitle:{type:String},chartTitleIsShow:{type:Boolean,default:!1},height:{type:Number,default:400}},setup(t){const e={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"},title:{display:t.chartTitleIsShow,text:t.chartTitle}}};return()=>(0,i.h)(T.$I,{chartData:t.chartData,chartOptions:e,height:t.height})}});const Z=j;var A=Z,K={name:"CityView",components:{PageTitle:L.Z,ButtonFilter:D,ButtonPagination:N,DoughnutChart:A},props:{dataList:Array,latestDate:String,taiwanList:Array},data(){return{cityCurrentIndex:0,perPageList:[10,15,20,25,30],perPageIndex:0,currentPage:1}},computed:{cityList(){const t={sort:this.taiwanList,map:{}};return t.sort.forEach((e=>{t.map[e]={sort:[],map:{}}})),this.dataList.forEach((({id:e,date:a,city:i,town:s,gender:n,overseas:r,age:l})=>{t.map[i].sort.push(e),t.map[i].map[e]={date:a,town:s,gender:n,overseas:r,age:l}})),t},cityPrevList(){return[{title:"全部縣市",num:this.dataList.filter((({date:t})=>t<=this.latestDate)).filter((({overseas:t})=>!t)).length}]},cityLocalList(){const t=this.cityList.sort.filter(((t,e)=>0!==e)).map((t=>({title:t,num:this.cityList.map[t].sort.length})));return this.cityPrevList.concat(t)},localList(){const t=this.cityPrevList.length;if(this.cityCurrentIndex>=t){const e=this.cityList.sort[this.cityCurrentIndex-(t-1)];return this.dataList.filter((({city:t})=>t===e))}return this.dataList.filter((({overseas:t})=>!t))},perPage(){return this.perPageList[this.perPageIndex]},pageList(){const t=(this.currentPage-1)*this.perPage,e=t+this.perPage;return this.localList.slice(t,e)},totalPages(){return Math.ceil(this.localList.length/this.perPage)},chartData(){let t=[],e=[];if(this.cityCurrentIndex>=this.cityPrevList.length){const a={sort:[],map:{}};this.dataList.filter((({city:t})=>t===this.cityList.sort[this.cityCurrentIndex])).forEach((({id:t,date:e,town:i})=>{a.map[i]||(a.sort.push(i),a.map[i]={sort:[],map:{}}),a.map[i].sort.push(t),a.map[i].map[t]={date:e}})),t=a.sort.sort(((t,e)=>a.map[e].sort.length-a.map[t].sort.length)),e=t.map((t=>a.map[t].sort.length))}else t=this.cityList.sort.filter(((t,e)=>0!==e)).sort(((t,e)=>this.cityList.map[e].sort.length-this.cityList.map[t].sort.length)),e=t.map((t=>this.cityList.map[t].sort.length));const a=["#6366e0","#e8537a","#dc3545","#fd7e14","#ebcd71","#20c997","#67acd6"],i=t.map(((t,e)=>a[(e+a.length)%a.length]));return{labels:t,datasets:[{backgroundColor:i,data:e}]}}},methods:{changeIndexHandler(t){this.cityCurrentIndex=t,this.changeCurrentPage(1)},changeCurrentPage(t){this.currentPage=(t+this.totalPages+1)%(this.totalPages+1)}}};const S=(0,b.Z)(K,[["render",w]]);var W=S}}]);
//# sourceMappingURL=925.f955e015.js.map